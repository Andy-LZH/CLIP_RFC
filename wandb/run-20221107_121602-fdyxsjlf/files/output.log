
  7%|██████████▏                                                                                                                               | 5/68 [00:01<00:14,  4.24it/s]
loss:  tensor(0.7656, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.8141, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(1.2676, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.7622, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6953, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(1.5005, device='cuda:0', grad_fn=<NllLossBackward0>)

 21%|████████████████████████████▏                                                                                                            | 14/68 [00:03<00:12,  4.24it/s]
loss:  tensor(0.7132, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5578, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(1.3506, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(1.1266, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.7556, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(1.0275, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6701, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4847, device='cuda:0', grad_fn=<NllLossBackward0>)

 34%|██████████████████████████████████████████████▎                                                                                          | 23/68 [00:05<00:11,  4.01it/s]
loss:  tensor(0.6742, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5706, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5734, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4418, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5824, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4962, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4469, device='cuda:0', grad_fn=<NllLossBackward0>)

 46%|██████████████████████████████████████████████████████████████▍                                                                          | 31/68 [00:07<00:08,  4.21it/s]
loss:  tensor(0.5129, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4671, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5307, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6455, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5547, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4518, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6221, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4702, device='cuda:0', grad_fn=<NllLossBackward0>)

 59%|████████████████████████████████████████████████████████████████████████████████▌                                                        | 40/68 [00:09<00:06,  4.23it/s]
loss:  tensor(0.5738, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4975, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4625, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4054, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.3903, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.9382, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.3458, device='cuda:0', grad_fn=<NllLossBackward0>)

 72%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 49/68 [00:11<00:04,  4.61it/s]
loss:  tensor(0.7193, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6085, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.2909, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4941, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.6361, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4526, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4902, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4439, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4895, device='cuda:0', grad_fn=<NllLossBackward0>)

 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 58/68 [00:13<00:02,  4.55it/s]
loss:  tensor(0.4548, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5486, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5832, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4379, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4646, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4351, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4259, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5579, device='cuda:0', grad_fn=<NllLossBackward0>)

 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 66/68 [00:15<00:00,  3.89it/s]
loss:  tensor(0.4790, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4292, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5645, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.5178, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.3874, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.4006, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.3630, device='cuda:0', grad_fn=<NllLossBackward0>)
loss:  tensor(0.2034, device='cuda:0', grad_fn=<NllLossBackward0>)
Training loss: 0.01827210944959487, accuracy: 0.7195402298850575
label:  [0]
tensor([[0.5470, 0.4530]])
tensor([[0.5470, 0.4530]])
label:  [0]
tensor([[0.6619, 0.3381]])
tensor([[0.6619, 0.3381]])
label:  [1]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [00:15<00:00,  4.28it/s]
  0%|▎                                                                                                                                        | 2/977 [00:00<00:16, 57.42it/s]
Traceback (most recent call last):
  File "train_MHIST.py", line 212, in <module>
    train(train_data, test_data, model_backbone, max_epoch)
  File "train_MHIST.py", line 181, in train
    print(y_pred[label].data.cpu())
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.